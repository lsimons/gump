

<html>
	<head>
		<LINK REL=StyleSheet HREF="./style/style.css" TYPE="text/css">
	</head>
		<a href="usage.html">&lt;--previous</a> |
	<a href="./index.html">contents</a> |
	<a href="admin.html">next--&gt;</a> 

	<hr>
	<body>
        <h1>Examples</h1>
		
<h2> Project Structure </h2>

<p> In order to to demonstrate the workings of PyLid, we have created a small
mock-project with the following directory structure: </p>

<pre>
    /examples
        silly.py
        useless.py
        tests/
            test_project.py
</pre>


<p> Here, "silly.py" and "useless.py" are our two project files. All our unit
tests live in the "tests" directory - in this case inside a single file called
"test_project.py". The source for this example project can be found in the
"examples" directory of the PyLid distribution. </p>


<h2> Running Unit Tests </h2>

<p> PyLid would usually be run from the "tests" directory. Note that the
default values for the covery path options (-i, -e, -b), means that all of the
project files are included for coverage, and all of the test files are excluded
from coverage. The following is a simple PyLid run, with no options: </p>

<code class="shell">
<pre>
&gt; pylid.py
...
----------------------------------------------------------------------
Ran 3 tests in 0.001s

OK
</pre>
</code>

<p> By default PyLid simply runs your tests using the default PyUnit text test
runner, without doing any coverage analysis. Below is the source for
test_project.py:</p>

<code>
<pre><div class="pythoncode"><font color="#C00000">import</font> <font color="#000000">unittest</font>
<font color="#C00000">import</font> <font color="#000000">silly</font><font color="#0000C0">,</font> <font color="#000000">useless</font>

<font color="#C00000">class</font> <font color="#000000">uSilly</font><font color="#0000C0">(</font><font color="#000000">unittest</font><font color="#0000C0">.</font><font color="#000000">TestCase</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#C00000">def</font> <font color="#000000">test_silly</font><font color="#0000C0">(</font><font color="#000000">self</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
        <font color="#000000">self</font><font color="#0000C0">.</font><font color="#000000">failUnless</font><font color="#0000C0">(</font><font color="#000000">silly</font><font color="#0000C0">.</font><font color="#000000">silly</font><font color="#0000C0">(</font><font color="#0000C0">)</font> <font color="#0000C0">==</font> <font color="#0080C0">2</font><font color="#0000C0">)</font>

    <font color="#C00000">def</font> <font color="#000000">test_sillier</font><font color="#0000C0">(</font><font color="#000000">self</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
        <font color="#000000">self</font><font color="#0000C0">.</font><font color="#000000">failUnless</font><font color="#0000C0">(</font><font color="#000000">silly</font><font color="#0000C0">.</font><font color="#000000">sillier</font><font color="#0000C0">(</font><font color="#0080C0">1</font><font color="#0000C0">)</font> <font color="#0000C0">==</font> <font color="#0080C0">1</font><font color="#0000C0">)</font>

<font color="#C00000">class</font> <font color="#000000">uUseless</font><font color="#0000C0">(</font><font color="#000000">unittest</font><font color="#0000C0">.</font><font color="#000000">TestCase</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#C00000">def</font> <font color="#000000">test_useless</font><font color="#0000C0">(</font><font color="#000000">self</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
        <font color="#000000">self</font><font color="#0000C0">.</font><font color="#000000">failUnless</font><font color="#0000C0">(</font><font color="#000000">useless</font><font color="#0000C0">.</font><font color="#000000">useless</font><font color="#0000C0">(</font><font color="#0000C0">)</font> <font color="#0000C0">==</font> <font color="#0080C0">0</font><font color="#0000C0">)</font><font color="#000000"></font></div></pre>
</code>


<p> Notice that we simply import "silly" and "useless" from here, even though
these modules are not really accessible from the "test" directory. We can do
this because the default argument to the project base option ("-b") is "..".
I.e. the /examples directory is incuded in Python's search path. We can now be
more specific about the tests we run:</p>

<code class="shell">
<pre>
&gt; pylid -vv test_project.uSilly
test_sillier (test_project.uSilly) ... ok
test_silly (test_project.uSilly) ... ok

----------------------------------------------------------------------
Ran 2 tests in 0.002s

OK
</pre>
</code>

<p> The "-vv" option tells PyLid to be very verbose - in this case, the names
of the unit tests are printed as they are run. As you can see, only the tests
in the specified test case have been run. </p>


<h2> Code Coverage </h2>

<p> We can generate a code coverage stats summary simply by passing the "-s"
flag to PyLid: </p> 

<code class="shell">
<pre>
&gt; pylid.py -s
----------------------------------------------------------------------
Ran 3 tests in 0.001s

OK


                    Coverage
                    ========

[run ] [tot ] [percent]
=======================
[5   ] [6   ] [83.33 %]:     ../useless.py  
                             5 
[8   ] [13  ] [61.53 %]:     ../silly.py  
                             7  [14...17] 

Summary:
                Statements Total: 19
                Statements Run:   13
                Percentage:       68.42%

</pre>
</code>


<p> The output above tells us that 8 of the 13 statements in "silly.py", or
61.53%, were run. Just below the filename is a brief summary of the lines that
were not covered - in this case line 7, and lines 14-17 inclusive. If we now
pass the "-p" flag to PyLid, an annotated version of each file is passed to our
pager. For silly.py, the annotated version looks something like this:</p>


<code>
def&nbsp;silly():<br>&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;1<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;else:<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;0<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;x<br><br>def&nbsp;sillier(a):<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;a<br><br>def&nbsp;untested(a):<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a:<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(10):<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;a&nbsp;+&nbsp;1<br>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;a<br>
</code>

<p> Of course, coverage analysis can be combined with any of the other
arguments to PyLid - we can view the code coverage for a specific test, for
example, or prompt the unit test engine to give us more verbose output. </p>

	</body>
	<hr>
    <table width="100%">
        <tr>
            <td>
                	<a href="usage.html">&lt;--previous</a> |
	<a href="./index.html">contents</a> |
	<a href="admin.html">next--&gt;</a> 

            </td>
            <td align="right">
                (11/16/04)
            </td>
        </tr>
    </table>
	<center> Pylid Manual </center>
</html>
